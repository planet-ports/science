<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>10&nbsp;Ordinary Differential Equations</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x"><span style="font-weight: bold">Science Collection:</span> Reference Manual</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="introduction.html" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="using.html" class="tocviewlink" data-pltdoc="x">Using the Science Collection</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="error-handling.html" class="tocviewlink" data-pltdoc="x">Error Handling</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="mathematical-functions.html" class="tocviewlink" data-pltdoc="x">Mathematical Functions</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="special-functions.html" class="tocviewlink" data-pltdoc="x">Special Functions</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="random-numbers.html" class="tocviewlink" data-pltdoc="x">Random Number Generation</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="random-distributions.html" class="tocviewlink" data-pltdoc="x">Random Number Distributions</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="statistics.html" class="tocviewlink" data-pltdoc="x">Statistics</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="histograms.html" class="tocviewlink" data-pltdoc="x">Histograms</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Ordinary Differential Equations</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="chebyshev.html" class="tocviewlink" data-pltdoc="x">Chebyshev Approximations</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="fft.html" class="tocviewlink" data-pltdoc="x">Fast Fourier Transforms</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="physical-constants.html" class="tocviewlink" data-pltdoc="x">Physical Constants</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="unsafe-ops-utils.html" class="tocviewlink" data-pltdoc="x">Unsafe Operations Utilities</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="gfdl.html" class="tocviewlink" data-pltdoc="x">GNU Free Documentation License</a></td></tr><tr><td align="right"></td><td><a href="doc-bibliography.html" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>10&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Ordinary Differential Equations</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">10.1&nbsp;</td><td><a href="#%28part._.Defining_the_.O.D.E_.System%29" class="tocviewlink" data-pltdoc="x">Defining the ODE System</a></td></tr><tr><td align="right">10.2&nbsp;</td><td><a href="#%28part._.Adaptive_.Step-.Size_.Control%29" class="tocviewlink" data-pltdoc="x">Adaptive Step-<wbr></wbr>Size Control</a></td></tr><tr><td align="right">10.3&nbsp;</td><td><a href="#%28part._.Evolution%29" class="tocviewlink" data-pltdoc="x">Evolution</a></td></tr><tr><td align="right">10.4&nbsp;</td><td><a href="#%28part._.O.D.E_.Examples%29" class="tocviewlink" data-pltdoc="x">ODE Examples</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">10.1<tt>&nbsp;</tt></span><a href="#(part._.Defining_the_.O.D.E_.System)" class="tocsubseclink" data-pltdoc="x">Defining the ODE System</a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym">ode-<wbr></wbr>system</span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-function-eval))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>system-<wbr></wbr>function-<wbr></wbr>eval</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-system-function-eval))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">unchecked-<wbr></wbr>ode-<wbr></wbr>system-<wbr></wbr>function-<wbr></wbr>eval</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-jacobian-eval))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>system-<wbr></wbr>jacobian-<wbr></wbr>eval</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-system-jacobian-eval))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">unchecked-<wbr></wbr>ode-<wbr></wbr>system-<wbr></wbr>jacobian-<wbr></wbr>eval</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">10.1.1<tt>&nbsp;</tt></span><a href="#(part._.Stepping_.Functions)" class="tocsubseclink" data-pltdoc="x">Stepping Functions</a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-type~3f))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>step-<wbr></wbr>type?</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step~3f))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>step?</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-step))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>ode-<wbr></wbr>step</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-reset))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>step-<wbr></wbr>reset</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-step-reset))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">unchecked-<wbr></wbr>ode-<wbr></wbr>step-<wbr></wbr>reset</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-name))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>step-<wbr></wbr>name</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-order))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>step-<wbr></wbr>order</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-apply))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>step-<wbr></wbr>apply</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-step-apply))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">unchecked-<wbr></wbr>ode-<wbr></wbr>step-<wbr></wbr>apply</span></span></span></a></td></tr><tr><td><a href="#(form._((planet._ode-initval..rkt._(williams._science..plt._4._7))._rk2-ode-type))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktStxLink">rk2-<wbr></wbr>ode-<wbr></wbr>type</span></span></span></a></td></tr><tr><td><a href="#(form._((planet._ode-initval..rkt._(williams._science..plt._4._7))._rk4-ode-type))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktStxLink">rk4-<wbr></wbr>ode-<wbr></wbr>type</span></span></span></a></td></tr><tr><td><a href="#(form._((planet._ode-initval..rkt._(williams._science..plt._4._7))._rkf45-ode-type))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktStxLink">rkf45-<wbr></wbr>ode-<wbr></wbr>type</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">10.2<tt>&nbsp;</tt></span><a href="#(part._.Adaptive_.Step-.Size_.Control)" class="tocsubseclink" data-pltdoc="x">Adaptive Step-<wbr></wbr>Size Control</a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._standard-control-new))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">standard-<wbr></wbr>control-<wbr></wbr>new</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._control-y-new))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">control-<wbr></wbr>y-<wbr></wbr>new</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._control-yp-new))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">control-<wbr></wbr>yp-<wbr></wbr>new</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-control))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>ode-<wbr></wbr>control</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-control-init))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>control-<wbr></wbr>init</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-control-h-adjust))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>control-<wbr></wbr>h-<wbr></wbr>adjust</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-control-name))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>control-<wbr></wbr>name</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">10.3<tt>&nbsp;</tt></span><a href="#(part._.Evolution)" class="tocsubseclink" data-pltdoc="x">Evolution</a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve~3f))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym">ode-<wbr></wbr>evolve?</span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-evolve))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>ode-<wbr></wbr>evolve</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-count))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>evolve-<wbr></wbr>count</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-failed-steps))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>evolve-<wbr></wbr>failed-<wbr></wbr>steps</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-apply))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>evolve-<wbr></wbr>apply</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-evolve-apply))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">unchecked-<wbr></wbr>ode-<wbr></wbr>evolve-<wbr></wbr>apply</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-reset))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">ode-<wbr></wbr>evolve-<wbr></wbr>reset</span></span></span></a></td></tr><tr><td><a href="#(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-evolve-reset))" class="tocsubnonseclink" data-pltdoc="x"><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><span class="RktValLink">unchecked-<wbr></wbr>ode-<wbr></wbr>evolve-<wbr></wbr>reset</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">10.4<tt>&nbsp;</tt></span><a href="#(part._.O.D.E_.Examples)" class="tocsubseclink" data-pltdoc="x">ODE Examples</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="histograms.html" title="backward to &quot;9 Histograms&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Science Collection: Reference Manual&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="chebyshev.html" title="forward to &quot;11 Chebyshev Approximations&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>10<tt>&nbsp;</tt><a name="(part._ode)"></a><a name="(mod-path._(planet._williams/science/ode-initval))"></a>Ordinary Differential Equations</h3><table cellspacing="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Defining_the_.O.D.E_.System%29" class="toclink" data-pltdoc="x">10.1<span class="hspace">&nbsp;</span>Defining the ODE System</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Stepping_.Functions%29" class="toclink" data-pltdoc="x">10.1.1<span class="hspace">&nbsp;</span>Stepping Functions</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Adaptive_.Step-.Size_.Control%29" class="toclink" data-pltdoc="x">10.2<span class="hspace">&nbsp;</span>Adaptive Step-Size Control</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.Evolution%29" class="toclink" data-pltdoc="x">10.3<span class="hspace">&nbsp;</span>Evolution</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.O.D.E_.Examples%29" class="toclink" data-pltdoc="x">10.4<span class="hspace">&nbsp;</span>ODE Examples</a></p></td></tr></table><p>This chapter describes the functions for solving ordinary differential equation (ODE) initial value problems provided by the Science Collection.  The functions include a variety of low-level methods, such as Runge-Kutta and Bulirsch-Stoer routines, and higher level components for adaptive step-size control.  The components can be combined by the user to achieve the desired solution with full access to any intermediate steps, as needed.</p><p>The functions described in this chapter are defined in the <span class="stt">"ode-initval.rkt"</span> file in the Science Collection and are made available using the form:</p><p><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSByZXF1aXJlKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBwbGFuZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">planet</a></span><span class="stt"> </span><span class="RktSym">williams/science/ode-initval</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><h4>10.1<tt>&nbsp;</tt><a name="(part._.Defining_the_.O.D.E_.System)"></a>Defining the ODE System</h4><p>The routines solve the general n-dimensional first-order system:</p><p><span style="font-style: italic">dy</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic">/dt = f</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t, y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic">, ..., y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">n</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span>)<span style="font-style: italic"></span></p><p>for <span style="font-style: italic">i = </span>1<span style="font-style: italic">, ..., n</span>.  The stepping functions rely on the vector of derivatives <span style="font-style: italic">f</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span> and the Jacobian matrix <span style="font-style: italic">J</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">ij</span></span><span style="font-style: italic"> = df</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t, y</span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span>)<span style="font-style: italic">/dy</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">j</span></span><span style="font-style: italic"></span>.  A system of equations is defined using the <span class="RktSym">ode-system</span> structure.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBzdHJ1Y3QpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-params))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-dimension))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-jacobian))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-function))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-system))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system~3f))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._struct~3aode-system))"></a><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym">ode-system</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">function</span><span class="stt"> </span><span class="RktSym">jacobian</span><span class="stt"> </span><span class="RktSym">dimension</span><span class="stt"> </span><span class="RktSym">params</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-system%29%29" class="RktValLink" data-pltdoc="x">make-ode-system</a></span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">function</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L2Jhc2Uu%0D%0Acmt0IikgLT4pKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGxpc3RvZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGFueS9jKSkp%0D%0A" class="RktValLink" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktSym">jacobian</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIG9yL2MpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L2Jhc2Uu%0D%0Acmt0IikgLT4pKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGxpc3RvZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGFueS9jKSkp%0D%0A" class="RktValLink" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGZhbHNlL2MpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">false/c</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">dimension</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGV4YWN0LXBvc2l0%0D%0AaXZlLWludGVnZXI%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">exact-positive-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">params</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGxpc3RvZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGFueS9jKSkp%0D%0A" class="RktValLink" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Defines a general ODE system with arbitrary parameters.</div></p><ul><li><p><span class="RktSym">function</span>&#8212;<wbr></wbr>a function <span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBsYW1iZGEpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">t</span><span class="stt"> </span><span class="RktSym">y</span><span class="stt"> </span><span class="RktSym">dydt</span><span class="stt"> </span><span class="RktSym">params</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvc3R4Y2Fz%0D%0AZS1zY2hlbWUucmt0IikgLi4uKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span>.  This function should store the elements of <span style="font-style: italic">f</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t, y, params</span>)<span style="font-style: italic"></span> in the vector <span class="RktSym">dydt</span>, for arguments <span class="RktSym">t</span> and <span class="RktSym">y</span> and parameters <span class="RktSym">params</span>.</p></li><li><p><span class="RktSym">jacobian</span>&#8212;<wbr></wbr>a function <span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBsYW1iZGEpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">t</span><span class="stt"> </span><span class="RktSym">y</span><span class="stt"> </span><span class="RktSym">dfdy</span><span class="stt"> </span><span class="RktSym">dfdt</span><span class="stt"> </span><span class="RktSym">params</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvc3R4Y2Fz%0D%0AZS1zY2hlbWUucmt0IikgLi4uKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span>.  This function should store the elements of <span style="font-style: italic">df</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t, y, params</span>)<span style="font-style: italic">/dt</span> in the vector <span class="RktSym">dfdt</span> and the Jacobian matrix <span style="font-style: italic">J</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">ij</span></span><span style="font-style: italic"></span> in the vector <span class="RktSym">dfdy</span> as a row-major matrix <span style="font-style: italic">J</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">ij</span></span><span style="font-style: italic"> = dfdy</span>(<span style="font-style: italic">i * dimension + j</span>)<span style="font-style: italic"></span>, where <span style="font-style: italic">dimension</span> is the dimension of the system.  Some of the simpler solver algorithms do not make use of the Jacobian matrix, so it is not always strictly necessary to provide it.  The <span class="RktSym">jacobian</span> field of the structure can be <span class="RktVal">#f</span> for those algorithms.  However, it is useful to provide the Jacobian to allow the solver algorithms to be interchanged.  The best algorithms make use of the Jacobian.</p></li><li><p><span class="RktSym">dimension</span>&#8212;<wbr></wbr>the dimension of the system of equations.</p></li><li><p><span class="RktSym">params</span>&#8212;<wbr></wbr>a list if the arbitrary parameters of the system.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-function-eval))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system-function-eval%29%29" class="RktValLink" data-pltdoc="x">ode-system-function-eval</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">ode-system</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ode-system</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-system-function-eval))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._unchecked-ode-system-function-eval%29%29" class="RktValLink" data-pltdoc="x">unchecked-ode-system-function-eval</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">ode-system</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ode-system</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Evaluates the system function for <span class="RktVar">ode-system</span>. This function should store the elements of <span style="font-style: italic">f</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t, y, params</span>)<span style="font-style: italic"></span> in the vector <span class="RktVar">dydt</span>, for arguments <span class="RktVar">t</span> and <span class="RktVar">y</span> and parameters <span class="RktSym">params</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-system-jacobian-eval))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system-jacobian-eval%29%29" class="RktValLink" data-pltdoc="x">ode-system-jacobian-eval</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">ode-system</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dfdt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ode-system</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dfdt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-system-jacobian-eval))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._unchecked-ode-system-jacobian-eval%29%29" class="RktValLink" data-pltdoc="x">unchecked-ode-system-jacobian-eval</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">ode-system</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dfdt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ode-system</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dfdt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS92ZWN0b3Iucmt0IikgdmVjdG9yb2YpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Evaluates the Jacobian function for <span class="RktVar">ode-system</span>. This function should store the elements of <span style="font-style: italic">df</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t, y, params</span>)<span style="font-style: italic">/dt</span> in the vector <span class="RktVar">dfdt</span> and the Jacobian matrix <span style="font-style: italic">J</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">ij</span></span><span style="font-style: italic"></span> in the vector <span class="RktSym">dfdy</span> as a row-major matrix <span style="font-style: italic">J</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">ij</span></span><span style="font-style: italic"> = dfdy</span>(<span style="font-style: italic">i * dimension + j</span>)<span style="font-style: italic"></span>, where <span style="font-style: italic">dimension</span> is the dimension of the system.</div></p><h5>10.1.1<tt>&nbsp;</tt><a name="(part._.Stepping_.Functions)"></a>Stepping Functions</h5><p>The lowest level components are the <span style="font-style: italic">stepping functions</span> that advance a solution from time <span style="font-style: italic">t</span> to <span style="font-style: italic">t + h</span> for a fixed step size <span style="font-style: italic">h</span> and estimate the resulting local error.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-type~3f))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-type~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step-type?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJvb2xlYW4%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGFueS9jKSkp%0D%0A" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns true, <span class="RktVal">#t</span>, if <span class="RktVar">x</span> is an ODE step type and false, <span class="RktVal">#f</span>, otherwise.  ODE step types are defined by the different ODE solvers.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step~3f))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJvb2xlYW4%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGFueS9jKSkp%0D%0A" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns true, <span class="RktVal">#t</span>, if <span class="RktVar">x</span> is an ODE step and false, <span class="RktVal">#f</span>, otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-step))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-step%29%29" class="RktValLink" data-pltdoc="x">make-ode-step</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">step-type</span><span class="hspace">&nbsp;</span><span class="RktVar">dim</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step-type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-type~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step-type?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dim</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">exact-non-negative-integer?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a newly created instance of a stepping function of type <span class="RktVar">step-type</span> for a system of <span class="RktVar">dim</span> dimensions.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-reset))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-reset%29%29" class="RktValLink" data-pltdoc="x">ode-step-reset</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">step</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-step-reset))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._unchecked-ode-step-reset%29%29" class="RktValLink" data-pltdoc="x">unchecked-ode-step-reset</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">step</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Resets the stepping function <span class="RktVar">step</span>.  It should be used whenever the next use of <span class="RktVar">step</span> will not be a continuation of a previous step.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-name))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-name%29%29" class="RktValLink" data-pltdoc="x">ode-step-name</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">step</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHN0cmluZz8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the name of the stepping function <span class="RktVar">step</span> as a string.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-order))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-order%29%29" class="RktValLink" data-pltdoc="x">ode-step-order</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">step</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIG5hdHVyYWwtbnVtYmVyL2MpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">natural-number/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the order of the stepping function <span class="RktVar">step</span> on theprevious step.  This order can vary of the stepping function itself is adaptive.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-step-apply))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-apply%29%29" class="RktValLink" data-pltdoc="x">ode-step-apply</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">step</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">h</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y-err</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt-in</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt-out</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">h</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y-err</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt-in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt-out</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-step-apply))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._unchecked-ode-step-apply%29%29" class="RktValLink" data-pltdoc="x">unchecked-ode-step-apply</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">step</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">h</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y-err</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt-in</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt-out</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZvaWQ%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">void?</a></span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">h</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y-err</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt-in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt-out</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Applies the stepping function <span class="RktVar">step</span> to the system of equations defined by <span class="RktVar">dydt</span> using the step size <span class="RktVar">h</span> to advance the system from time <span class="RktVar">t</span> and state <span class="RktVar">y</span> to time <span style="font-style: italic">t + h</span>.  The new state of the system is stored in <span class="RktVar">y</span> on output with an estimate of the absolute error in each component stored in <span class="RktVar">y-err</span>.  If the argument <span class="RktVar">dydt-in</span> is not <span class="RktVal">#f</span>, it should be a vector containing the derivatives for the system at time <span class="RktVar">t</span> on input.  This is optional as the derivatives will be computed internally if they are not provided, but allows the reuse of existing derivative information.  On output the new derivatives of the system at time <span style="font-style: italic">t + h</span> will be stored in the vector <span class="RktVar">dydt-out</span>, if it is not <span class="RktVal">#f</span>.</div></p><p>The following stepping algorithms are available.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><a name="(form._((planet._ode-initval..rkt._(williams._science..plt._4._7))._rk2-ode-type))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28form._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._rk2-ode-type%29%29" class="RktStxLink" data-pltdoc="x">rk2-ode-type</a></span></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Embedded Runge-Kutta (2, 3) method.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><a name="(form._((planet._ode-initval..rkt._(williams._science..plt._4._7))._rk4-ode-type))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28form._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._rk4-ode-type%29%29" class="RktStxLink" data-pltdoc="x">rk4-ode-type</a></span></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">4<span style="vertical-align: super; font-size: 80%">th</span> order (classical) Runge-Kutta.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><a name="(form._((planet._ode-initval..rkt._(williams._science..plt._4._7))._rkf45-ode-type))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28form._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._rkf45-ode-type%29%29" class="RktStxLink" data-pltdoc="x">rkf45-ode-type</a></span></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Embedded (classical) Runge-Kutta-Fehberg (4, 5) method.  This method is a good general-purpose integrator.</div></p><h4>10.2<tt>&nbsp;</tt><a name="(part._.Adaptive_.Step-.Size_.Control)"></a>Adaptive Step-Size Control</h4><p>The control function examines the proposed changes to the solution and its error estimate produced by a stepping function and attempts to determine the optimal step size for a user-specified level of error.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._standard-control-new))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._standard-control-new%29%29" class="RktValLink" data-pltdoc="x">standard-control-new</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">eps-abs</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">eps-rel</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">a-y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">a-dydt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">ode-control?</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-abs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-rel</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a-y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a-dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new standard control object.  The standard control object is a four parameter heuristic based on absolute and relative errors <span class="RktVar">eps-abs</span> and <span class="RktVar">eps-rel</span> and scaling factors <span class="RktVar">a-y</span> and <span class="RktVar">a-dydt</span> for the system state <span style="font-style: italic">y</span>{<span style="font-style: italic">t</span>}<span style="font-style: italic"></span> and derivatives <span style="font-style: italic">y</span>&prime;<span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span>, respectively.</div></p><p>The step size adjustment procedure for this method begins by computing the desired error level <span style="font-style: italic">D</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>, for each component</p><p><span style="font-style: italic">D</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"> = eps</span><span style="vertical-align: sub; font-size: 80%">abs</span><span style="font-style: italic"> + eps</span><span style="vertical-align: sub; font-size: 80%">rel</span><span style="font-style: italic"> &#215; </span>(<span style="font-style: italic">a</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">y</span></span><span style="font-style: italic">|y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic">| + a</span><span style="vertical-align: sub; font-size: 80%">dydt</span><span style="font-style: italic">h|y</span>&prime;<span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic">|</span>)<span style="font-style: italic"></span></p><p>and comparing it with the observed error <span style="font-style: italic">E</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"> = |yerr</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic">|</span>.  If the observed error <span style="font-style: italic">E</span> exceeds the desired error level <span style="font-style: italic">D</span> by more than 10% for any component, then the method reduces the step size by an appropriate factor</p><p><span style="font-style: italic">h</span><span style="vertical-align: sub; font-size: 80%">new</span><span style="font-style: italic"> = h</span><span style="vertical-align: sub; font-size: 80%">old</span><span style="font-style: italic"> &#215; S &#215; </span>(<span style="font-style: italic">E/D</span>)<span style="font-style: italic"></span><span style="vertical-align: super; font-size: 80%">-1/q</span></p><p>where <span style="font-style: italic">q</span> is the consistency order of the method (e.g., <span style="font-style: italic">q = </span>4<span style="font-style: italic"></span> for 4(5) embedded RK), and <span style="font-style: italic">S</span> is a safety factor of 0.9.  The ratio <span style="font-style: italic">E/D</span> is taken to be the maximim of the ratios <span style="font-style: italic">E</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic">/D</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>.</p><p>If the observed error <span style="font-style: italic">E</span> is less than 50% of the desired level <span style="font-style: italic">D</span> for the maximum ratio <span style="font-style: italic">E</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic">/D</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>, then the algorithm takes the opportunity to increase the step size to bring the error in line with the desired level</p><p><span style="font-style: italic">h</span><span style="vertical-align: sub; font-size: 80%">new</span><span style="font-style: italic"> = h</span><span style="vertical-align: sub; font-size: 80%">old</span><span style="font-style: italic"> &#215; S &#215; </span>(<span style="font-style: italic">E/D</span>)<span style="font-style: italic"></span><span style="vertical-align: super; font-size: 80%">-1/(q+1)</span>.</p><p>This emcompasses all the standard scaling methods.  To avoid uncontrolled changes in the step size, the overall scaling factor is limited to the range &#8533; to 5.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._control-y-new))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._control-y-new%29%29" class="RktValLink" data-pltdoc="x">control-y-new</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">eps-abs</span><span class="hspace">&nbsp;</span><span class="RktVar">eps-rel</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-abs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-rel</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new control object that will keep the local error within an absolute error of <span class="RktVar">eps-abs</span> and relative error <span class="RktVar">eps-rel</span> with respect to the solution <span style="font-style: italic">y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span>.  This is equivalent to the standard control object with <span class="RktSym">a-y</span> = 1 and <span class="RktSym">a-dydt</span> = 0.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._control-yp-new))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._control-yp-new%29%29" class="RktValLink" data-pltdoc="x">control-yp-new</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">eps-abs</span><span class="hspace">&nbsp;</span><span class="RktVar">eps-rel</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-abs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-rel</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new control object that will keep the local error within an absolute error of <span class="RktVar">eps-abs</span> and relative error <span class="RktVar">eps-rel</span> with respect to the derivatives of the solution <span style="font-style: italic">y</span>&prime;<span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span>.  This is equivalent to the standard control object with <span class="RktSym">a-y</span> = 0 and <span class="RktSym">a-dydt</span> = 1.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-control))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-control%29%29" class="RktValLink" data-pltdoc="x">make-ode-control</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">control-type</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">control-type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-control-type?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a new instance of a control function of type <span class="RktVar">control-type</span>.  This function is only needed for defining new types of control functions.  For most purposes, the standard control functions describes above should be sufficient.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-control-init))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-control-init%29%29" class="RktValLink" data-pltdoc="x">ode-control-init</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">control</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">eps-abs</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">eps-rel</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">a-y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">a-dydt</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">control</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-abs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">eps-rel</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a-y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">a-dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Initializes the control function <span class="RktVar">control</span> with the parameters <span class="RktVar">eps-abs</span> (absolute error), <span class="RktVar">eps-rel</span> (relative error), <span class="RktVar">a-y</span> (scaling factor for <span style="font-style: italic">y</span>), and <span class="RktVar">a-dydt</span> (scaling factor for derivatives.)</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-control-h-adjust))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-control-h-adjust%29%29" class="RktValLink" data-pltdoc="x">ode-control-h-adjust</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">control</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">step</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y-err</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">dydt</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">h</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGludGVnZXItaW4pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">integer-in</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">control</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y-err</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dydt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">h</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveD8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">box?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Adjusts the step size <span class="RktVar">h</span> using the control function <span class="RktVar">control</span> and the current values of <span class="RktVar">y</span>, <span class="RktVar">y-err</span>, and <span class="RktVar">dydt</span>.  The stepping function <span class="RktVar">step</span> is also needed to determine the order of the method.  If the error in the <span class="RktVar">y</span> values <span class="RktVar">y-err</span> is found to be too large, then the step size <span class="RktVar">h</span> is reduced and the function returns -1.  If the error is sufficiently small, then <span class="RktVar">h</span> may be increased and 1 is returned.  The function returns 0 if the step size is unchanged.  The goal of the function is to estimate the largest step size that satisfies the user-specified accuracy requirements for the current point.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-control-name))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-control-name%29%29" class="RktValLink" data-pltdoc="x">ode-control-name</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">control</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHN0cmluZz8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">string?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">control</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the name of the control function <span class="RktVar">control</span>.  For example,</div></p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVal">"control method is '~a'~n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-control-name%29%29" class="RktValLink" data-pltdoc="x">ode-control-name</a></span><span class="hspace">&nbsp;</span><span class="RktVar">control</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>would print something like</p><p><table cellspacing="0"><tr><td><p><span class="stt"><span class="stt">control method is 'standard'</span></span></p></td></tr></table></p><h4>10.3<tt>&nbsp;</tt><a name="(part._.Evolution)"></a>Evolution</h4><p>The highest-level of the system is the evolution function that combines the results of a stepping function and control function to reliably advance the solution forward over an interval <span style="font-style: italic"></span>(<span style="font-style: italic">t</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic">, t</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span>.  If the control function signals that the step size should be decreased, the evolution function backs out of the current step and tries the proposed smaller step size.  This process is continued until an acceptable step size is found.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve~3f))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym">ode-evolve?</span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJvb2xlYW4%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvY29udHJhY3QvcHJpdmF0%0D%0AZS9taXNjLnJrdCIpIGFueS9jKSkp%0D%0A" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns true, <span class="RktVal">#t</span>, if <span class="RktVar">x</span> an ODE evolver.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._make-ode-evolve))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-evolve%29%29" class="RktValLink" data-pltdoc="x">make-ode-evolve</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">dim</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">dim</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGV4YWN0LXBvc2l0%0D%0AaXZlLWludGVnZXI%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">exact-positive-integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a new instance of an evolution function for a system of <span class="RktVar">dim</span> dimensions.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-count))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-count%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-count</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">evolve</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGV4YWN0LW5vbm5l%0D%0AZ2F0aXZlLWludGVnZXI%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">evolve</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the number of steps <span class="RktVar">evolve</span> has iterated.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-failed-steps))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-failed-steps%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-failed-steps</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">evolve</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGV4YWN0LW5vbm5l%0D%0AZ2F0aXZlLWludGVnZXI%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">evolve</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the number of steps for <span class="RktVar">evolve</span> that have failed &#8212;<wbr></wbr> i.e., required adjustment to the time step.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" class="prototype RForeground"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-apply))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-apply%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-apply</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">evolve</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">control</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">step</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">system</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t1</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">h</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">evolve</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">control</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">system</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveD8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">box?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">h</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveD8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">box?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-evolve-apply))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._unchecked-ode-evolve-apply%29%29" class="RktValLink" data-pltdoc="x">unchecked-ode-evolve-apply</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">evolve</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">control</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">step</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">system</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">t1</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">h</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">y</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">evolve</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">control</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-control?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">step</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step~3f%29%29" class="RktValLink" data-pltdoc="x">ode-step?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">system</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system~3f%29%29" class="RktValLink" data-pltdoc="x">ode-system?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveD8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">box?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t1</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">h</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveD8pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">box?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">y</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vector-of</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHJlYWw%2FKSkp%0D%0A" class="RktValLink" data-pltdoc="x">real?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Evolves the system from time <span class="RktVar">t</span> and position <span class="RktVar">y</span> using the stepping function <span class="RktVar">step</span>.  The new time and position are stored in <span class="RktVar">t</span> and <span class="RktVar">y</span> on output.  The initial step size is taken as <span class="RktVar">h</span>, but this may be modified using the control function <span class="RktVar">control</span> to achieve the appropriate bound, if necessary.  The routine may make several calls to <span class="RktVar">step</span> in order to determine the optimum step size.  If the step size has been changed, the value of <span class="RktVar">h</span> will be modified on output.  The maximum time <span class="RktVar">t1</span> is guaranteed not to be exceeded by the time step.  On the final time step, the value of <span class="RktVar">t</span> will be set to <span class="RktVar">t1</span> exactly.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._ode-evolve-reset))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-reset%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-reset</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">evolve</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">evolve</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((planet._ode-initval..rkt._(williams._science..plt._4._7))._unchecked-ode-evolve-reset))"></a><span title="Provided from: (planet williams/science/ode-initval)"><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._unchecked-ode-evolve-reset%29%29" class="RktValLink" data-pltdoc="x">unchecked-ode-evolve-reset</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">evolve</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L2NvbnRyYWN0L3ByaXZh%0D%0AdGUvbWlzYy5ya3QiKSBhbnkpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">any</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">evolve</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">ode-evolve?</span></td></tr></table></blockquote></div><div class="SIntrapara">Resets the evolution function <span class="RktVar">evolve</span>.  It should be used whenever the next use of <span class="RktVar">evolve</span> will not me a continuation of a previous step.</div></p><h4>10.4<tt>&nbsp;</tt><a name="(part._.O.D.E_.Examples)"></a>ODE Examples</h4><p><span style="font-weight: bold">Example:</span> The following programs solve the second-order nonlinear Van der Pol oscillator equation</p><p><span style="font-style: italic">x</span>&rdquo;<span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"> + &#956;x</span>&prime;<span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span>(<span style="font-style: italic">x</span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"> - </span>1<span style="font-style: italic"></span>)<span style="font-style: italic"> + x</span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"> = </span>0<span style="font-style: italic"></span>.</p><p>This can be converted into a first order system suitable for use with the routines described in this chapter by introducing a separate variable for the velocity, <span style="font-style: italic">y = x</span>&prime;<span style="font-style: italic"></span>(<span style="font-style: italic">t</span>)<span style="font-style: italic"></span></p><p><span style="font-style: italic">x</span>&prime;<span style="font-style: italic"> = y</span></p><p><span style="font-style: italic">y</span>&prime;<span style="font-style: italic"> = -r + &#956;y</span>(<span style="font-style: italic"></span>1<span style="font-style: italic"> - x</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span>.</p><p>The following example integrates the above system of equations from <span style="font-style: italic">t = </span>0<span style="font-style: italic">.</span>0<span style="font-style: italic"></span> to <span style="font-style: italic"></span>1<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic">.</span>0<span style="font-style: italic"></span> in increments of <span style="font-style: italic"></span>0<span style="font-style: italic">.</span>0<span style="font-style: italic"></span>1<span style="font-style: italic"></span> using a 4<span style="vertical-align: super; font-size: 80%">th</span> order Runge-Kutta stepping function.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgcGFydCAoIihsaWIgc2NyaWJibGluZ3MvZ3VpZGUvZ3Vp%0D%0AZGUuc2NyYmwpIiAiaGFzaC1sYW5nIikpKQ%3D%3D%0D%0A" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgbW9kLXBhdGggInJhY2tldCIpKQ%3D%3D%0D%0A" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSByZXF1aXJlKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBwbGFuZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">planet</a></span><span class="hspace">&nbsp;</span><span class="RktSym">williams/science/ode-initval</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">plot</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBkZWZpbmUpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">func</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">params</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSBsZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">mu</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGNhcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">car</a></span><span class="hspace">&nbsp;</span><span class="RktSym">params</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1zZXQh%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">vector-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">y1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1zZXQh%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">vector-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIC0pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIC0pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpICopKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mu</span><span class="hspace">&nbsp;</span><span class="RktSym">y1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIC0pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpICopKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBkZWZpbmUpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSBsZXQqKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28form._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._rk4-ode-type%29%29" class="RktStxLink" data-pltdoc="x">rk4-ode-type</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">step</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-step%29%29" class="RktValLink" data-pltdoc="x">make-ode-step</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mu</span><span class="hspace">&nbsp;</span><span class="RktVal">10.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvc3lzdGVtLnJrdCIpIHN5%0D%0Ac3RlbSkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">system</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-system%29%29" class="RktValLink" data-pltdoc="x">make-ode-system</a></span><span class="hspace">&nbsp;</span><span class="RktSym">func</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGxpc3QpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mu</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">t1</span><span class="hspace">&nbsp;</span><span class="RktVal">100.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktVal">0.01</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3RvcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y-err</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIG1ha2UtdmVjdG9y%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">make-vector</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dydt-in</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIG1ha2UtdmVjdG9y%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">make-vector</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dydt-out</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIG1ha2UtdmVjdG9y%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">make-vector</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y0-values</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y1-values</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-system-function-eval%29%29" class="RktValLink" data-pltdoc="x">ode-system-function-eval</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvc3lzdGVtLnJrdCIpIHN5%0D%0Ac3RlbSkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">system</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">dydt-in</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSBsZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSB3aGVuKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIDwpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">t1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-step-apply%29%29" class="RktValLink" data-pltdoc="x">ode-step-apply</a></span><span class="hspace">&nbsp;</span><span class="RktSym">step</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">y-err</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">dydt-in</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">dydt-out</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvc3lzdGVtLnJrdCIpIHN5%0D%0Ac3RlbSkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">system</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKHF1b3RlICMla2VybmVsKSBzZXQhKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0-values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGNvbnMpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3RvcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y0-values</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKHF1b3RlICMla2VybmVsKSBzZXQhKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y1-values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGNvbnMpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3RvcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y1-values</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1zZXQh%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">vector-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">dydt-in</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">dydt-out</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1zZXQh%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">vector-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">dydt-in</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">dydt-out</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKHF1b3RlICMla2VybmVsKSBzZXQhKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpICspKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">points</span><span class="hspace">&nbsp;</span><span class="RktSym">y0-values</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-min</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-max</span><span class="hspace">&nbsp;</span><span class="RktVal">100.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-min</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span>.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-max</span><span class="hspace">&nbsp;</span><span class="RktVal">2.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Y"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">points</span><span class="hspace">&nbsp;</span><span class="RktSym">y1-values</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-min</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-max</span><span class="hspace">&nbsp;</span><span class="RktVal">100.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Y"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The following figures show the resulting plots.</p><p><img src="ode-example-1-y0-plot.png" alt="" /></p><p><img src="ode-example-1-y1-plot.png" alt="" /></p><p><span style="font-weight: bold">Example:</span> The following example evolves the above system of equations from <span style="font-style: italic">t = </span>0<span style="font-style: italic">.</span>0<span style="font-style: italic"></span> to <span style="font-style: italic"></span>1<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic">.</span>0<span style="font-style: italic"></span> maintaining an error in the <span style="font-style: italic">y</span> values of 10<span style="vertical-align: super; font-size: 80%">-6</span> using a 4<span style="vertical-align: super; font-size: 80%">th</span> order Runge-Kutta stepping function.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgcGFydCAoIihsaWIgc2NyaWJibGluZ3MvZ3VpZGUvZ3Vp%0D%0AZGUuc2NyYmwpIiAiaGFzaC1sYW5nIikpKQ%3D%3D%0D%0A" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgbW9kLXBhdGggInJhY2tldCIpKQ%3D%3D%0D%0A" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSByZXF1aXJlKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBwbGFuZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">planet</a></span><span class="hspace">&nbsp;</span><span class="RktSym">williams/science/ode-initval</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">plot</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBkZWZpbmUpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">func</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">params</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSBsZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">mu</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGNhcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">car</a></span><span class="hspace">&nbsp;</span><span class="RktSym">params</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1zZXQh%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">vector-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">y1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1zZXQh%0D%0AKSkp%0D%0A" class="RktValLink" data-pltdoc="x">vector-set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIC0pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIC0pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpICopKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mu</span><span class="hspace">&nbsp;</span><span class="RktSym">y1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIC0pKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpICopKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvYmFzZS5y%0D%0Aa3QiKSBkZWZpbmUpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSBsZXQqKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28form._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._rk4-ode-type%29%29" class="RktStxLink" data-pltdoc="x">rk4-ode-type</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">step</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-step%29%29" class="RktValLink" data-pltdoc="x">make-ode-step</a></span><span class="hspace">&nbsp;</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">control</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._control-y-new%29%29" class="RktValLink" data-pltdoc="x">control-y-new</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1e-006</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">evolve</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-evolve%29%29" class="RktValLink" data-pltdoc="x">make-ode-evolve</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mu</span><span class="hspace">&nbsp;</span><span class="RktVal">10.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvc3lzdGVtLnJrdCIpIHN5%0D%0Ac3RlbSkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">system</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._make-ode-system%29%29" class="RktValLink" data-pltdoc="x">make-ode-system</a></span><span class="hspace">&nbsp;</span><span class="RktSym">func</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGxpc3QpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mu</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveCkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">box</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">t1</span><span class="hspace">&nbsp;</span><span class="RktVal">100.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGJveCkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">box</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1e-006</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3RvcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y0-values</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y1-values</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSBsZXQpKSk%3D%0D%0A" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKGxpYiAicmFja2V0L3ByaXZhdGUvbGV0c3R4%0D%0ALXNjaGVtZS5ya3QiKSB3aGVuKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIDwpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHVuYm94KSkp%0D%0A" class="RktValLink" data-pltdoc="x">unbox</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">t1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-apply%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-apply</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">evolve</span><span class="hspace">&nbsp;</span><span class="RktSym">control</span><span class="hspace">&nbsp;</span><span class="RktSym">step</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgobGliICJyYWNrZXQvc3lzdGVtLnJrdCIpIHN5%0D%0Ac3RlbSkpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">system</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">t1</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKHF1b3RlICMla2VybmVsKSBzZXQhKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0-values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGNvbnMpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3RvcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHVuYm94KSkp%0D%0A" class="RktValLink" data-pltdoc="x">unbox</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y0-values</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZm9ybSAoKHF1b3RlICMla2VybmVsKSBzZXQhKSkp%0D%0A" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y1-values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIGNvbnMpKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">cons</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3RvcikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHVuYm94KSkp%0D%0A" class="RktValLink" data-pltdoc="x">unbox</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHZlY3Rvci1yZWYp%0D%0AKSk%3D%0D%0A" class="RktValLink" data-pltdoc="x">vector-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y1-values</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Number of iterations</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">= ~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-count%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-count</a></span><span class="hspace">&nbsp;</span><span class="RktSym">evolve</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Number of failed steps = ~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28planet._ode-initval..rkt._%28williams._science..plt._4._7%29%29._ode-evolve-failed-steps%29%29" class="RktValLink" data-pltdoc="x">ode-evolve-failed-steps</a></span><span class="hspace">&nbsp;</span><span class="RktSym">evolve</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">points</span><span class="hspace">&nbsp;</span><span class="RktSym">y0-values</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-min</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-max</span><span class="hspace">&nbsp;</span><span class="RktVal">100.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-min</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span>.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-max</span><span class="hspace">&nbsp;</span><span class="RktVal">2.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Y"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="/servlets/doc-search.rkt?tag=KCgzKSAwICgpIDAgKCkgKCkgKHEgZGVmICgocXVvdGUgIyVrZXJuZWwpIHByaW50ZikpKQ%3D%3D%0D%0A" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">points</span><span class="hspace">&nbsp;</span><span class="RktSym">y1-values</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-min</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-max</span><span class="hspace">&nbsp;</span><span class="RktVal">100.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:x-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:y-label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Y"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The following shows the printed output and resulting plots.</p><p><table cellspacing="0"><tr><td><p><span class="stt">Number of iterations<span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">= 84575</span></span></p></td></tr><tr><td><p><span class="stt"><span class="stt">Number of failed steps = 352</span></span></p></td></tr></table></p><p><img src="ode-example-2-y0-plot.png" alt="" /></p><p><img src="ode-example-2-y1-plot.png" alt="" /></p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="histograms.html" title="backward to &quot;9 Histograms&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Science Collection: Reference Manual&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="chebyshev.html" title="forward to &quot;11 Chebyshev Approximations&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>